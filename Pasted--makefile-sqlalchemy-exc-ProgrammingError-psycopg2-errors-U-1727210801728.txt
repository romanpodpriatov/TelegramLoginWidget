Причина ошибки

Ошибка:

makefile
Копировать код
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column users.is_admin does not exist
указывает на то, что ваш SQL-запрос пытается получить доступ к столбцу is_admin в таблице users, которого нет в вашей базе данных. Это происходит потому, что ваша модель User в SQLAlchemy определяет этот столбец, но он не был добавлен в существующую таблицу users в базе данных.

Решения

Добавление отсутствующего столбца вручную
Если вы не используете инструмент миграции, такой как Alembic, и ваша база данных не содержит критически важных данных, вы можете вручную добавить отсутствующий столбец.
Шаги:

Подключитесь к вашей базе данных PostgreSQL. Вы можете использовать инструмент командной строки psql или графический интерфейс, такой как pgAdmin.
Выполните SQL-команду для добавления столбца is_admin:
sql
Копировать код
ALTER TABLE users ADD COLUMN is_admin BOOLEAN DEFAULT FALSE;
Пояснения:

BOOLEAN: Тип данных для хранения логических значений (TRUE или FALSE).
DEFAULT FALSE: Устанавливает значение по умолчанию FALSE для новых записей.
Проверьте, что столбец был успешно добавлен:
sql
Копировать код
\d users
Это покажет структуру таблицы users, и вы должны увидеть новый столбец is_admin. 2. Использование инструмента миграции Alembic
Если вы планируете в будущем вносить изменения в схему базы данных, рекомендуется использовать инструмент миграции, такой как Alembic. Это обеспечит управление версиями схемы и упростит процесс обновления базы данных.

Шаги:

Установите Alembic:
bash
Копировать код
pip install alembic
Инициализируйте Alembic в вашем проекте:
bash
Копировать код
alembic init alembic
Это создаст директорию alembic с необходимыми файлами конфигурации.
Настройте файл alembic.ini:
Убедитесь, что строка подключения к базе данных (sqlalchemy.url) указана правильно.
Создайте первую миграцию:
bash
Копировать код
alembic revision --autogenerate -m "Add is_admin to users"
Это создаст файл миграции с необходимыми изменениями.
Примените миграцию:
bash
Копировать код
alembic upgrade head
Это выполнит миграцию и добавит столбец is_admin в таблицу users.
Проверьте, что миграция прошла успешно:
Подключитесь к базе данных и убедитесь, что столбец добавлен.